const vec3=glMatrix.vec3,canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d");canvas.width=canvas.offsetWidth,canvas.height=canvas.offsetHeight;let halfW=canvas.width/2,halfH=canvas.height/2,speed=.025;ctx.fillStyle="#000",ctx.fillRect(0,0,canvas.width,canvas.height);const random=(e,t)=>Math.floor(Math.random()*t*2)+e;class Star{constructor(){this.v=vec3.fromValues(random(0-halfW,halfW),random(0-halfH,halfH),random(1,12)),this.color="hsla(200,100%,"+random(50,100)+"%,1)"}draw(){this.v=vec3.add(vec3.create(),this.v,vec3.fromValues(0,0,0-speed));let e=this.v[0]/this.v[2],t=this.v[1]/this.v[2],a=this.v[0]/(this.v[2]+.5*speed),s=this.v[1]/(this.v[2]+.5*speed);ctx.strokeStyle=this.color,ctx.beginPath(),ctx.moveTo(e,t),ctx.lineTo(a,s),ctx.stroke(),(e<0-halfW||e>halfW||t<0-halfH||t>halfH)&&(this.v=vec3.fromValues(random(0-halfW,halfW),random(0-halfH,halfH),random(1,12)),this.color="hsla(200,100%,"+random(50,100)+"%,1)")}}class StarField{constructor(){this.stars=Array.from({length:250},()=>new Star)}draw(){ctx.translate(halfW,halfH);for(let e=0;e<250;e++)this.stars[e].draw()}}const starField=new StarField,draw=()=>{ctx.setTransform(1,0,0,1,0,0),ctx.fillStyle="rgba(0,0,0,0.2)",ctx.fillRect(0,0,canvas.width,canvas.height),starField.draw(),window.requestAnimationFrame(draw)};draw(),document.addEventListener("resize",()=>{canvas.width=canvas.offsetWidth,canvas.height=canvas.offsetHeight,halfW=canvas.width/2,halfH=canvas.height/2});const check=e=>{let t=e.el.querySelectorAll(".swiper-slide")[e.realIndex];if(15>=Math.abs(t.scrollHeight-t.clientHeight))return;t.classList.add("swiper-no-mousewheel"),e.allowTouchMove=!1,t.style.overflow="hidden",setTimeout(()=>t.style.overflow=null,300);let a=Date.now(),s,i,n=i=>{if(i<-20&&0===t.scrollTop&&!e.isBeginning||i>20&&t.scrollTop>t.scrollHeight-t.clientHeight-1&&!e.isEnd){let n=Date.now();(!s||n-s<200)&&n-a<1e3||n-a<500?s=n:(t.removeEventListener("wheel",l),t.removeEventListener("touchstart",o),t.removeEventListener("touchmove",r),t.classList.remove("swiper-no-mousewheel"),e.allowTouchMove=!0)}else s=null},l=e=>n(e.deltaY),o=e=>i=e.touches[0].pageY,r=e=>n(i-e.touches[0].pageY);t.addEventListener("wheel",l),t.addEventListener("touchstart",o),t.addEventListener("touchmove",r)},swiper=new Swiper(".swiper",{direction:"vertical",hashNavigation:{watchState:!0},mousewheel:{forceToAxis:!0},simulateTouch:!1,pagination:{el:".swiper-pagination",type:"progressbar"},on:{afterInit:e=>check(e),activeIndexChange:e=>check(e),transitionStart(e){speed=.125,e.el.classList.add("flash")},transitionEnd(e){speed=e.realIndex%5?.005:.025,e.el.classList.remove("flash")},resize:e=>check(e)}}),swiper2=new Swiper(".swiper2",{autoHeight:!0,autoplay:{delay:5e3,disableOnInteraction:!1,pauseOnMouseEnter:!0},grabCursor:!0,loop:!0,mousewheel:{forceToAxis:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper2-pagination",clickable:!0},zoom:!0,on:{activeIndexChange(){4===swiper.realIndex&&swiper.emit("activeIndexChange")}}});
